# Galaxy Defender 게임 제작 보고서

## 1. 프로젝트 개요

- **게임 제목**: Galaxy Defender
- **제작자**: Socoms
- **제작 기간**: 2024년 (개인 프로젝트)
- **사용 언어**: HTML5, CSS3, JavaScript (Vanilla JS)
- **팀 구성**: 개인
- **플랫폼**: 웹 브라우저 (크로스 플랫폼 - PC, 모바일)

---

## 2. 게임 기획 및 컨셉

### • 기획 의도
우주를 배경으로 한 액션 슈팅 게임을 제작하여, 플레이어가 적들을 처치하고 보스를 물리치며 점수를 획득하는 재미있는 게임 경험을 제공하고자 했습니다. HTML5 Canvas를 활용하여 별도의 게임 엔진 없이 순수 JavaScript로 구현하여 웹 브라우저에서 바로 실행 가능한 게임을 목표로 했습니다.

### • 장르
액션 슈팅, 생존, 아케이드

### • 핵심 아이디어
1. **웨이브 시스템**: 난이도가 점진적으로 증가하는 웨이브 기반 진행
2. **업그레이드 시스템**: 게임 중 획득한 코인으로 캐릭터 능력치를 영구적으로 강화
3. **다양한 특수 공격**: 미사일, 레이저, 스톰 등 다양한 특수 공격으로 전략적 플레이 유도
4. **콤보 시스템**: 연속 처치 시 보너스 점수로 게임의 재미 요소 추가
5. **반응형 디자인**: PC와 모바일 모두 지원하는 크로스 플랫폼 게임

### • 타겟 유저/플레이 스타일
- **타겟 유저**: 웹 브라우저 게임을 즐기는 모든 연령대의 사용자
- **플레이 스타일**: 
  - 캐주얼 게이머: 짧은 시간 동안 즐길 수 있는 간단한 조작
  - 하드코어 게이머: 최고 점수 달성을 위한 전략적 플레이와 업그레이드 최적화

---

## 3. 게임 시스템 구조

### • 게임 진행 방식
1. **메뉴 화면**: 게임 시작, 업그레이드 상점, 설정 메뉴 접근
2. **게임 플레이**: 
   - 적들이 위에서 아래로 이동하며 플레이어를 공격
   - 플레이어는 방향키로 이동하며 스페이스바로 발사
   - 적 처치 시 점수와 코인 획득
   - 파워업 아이템 수집으로 일시적 능력 강화
3. **웨이브 진행**: 
   - 시간 기반 또는 처치 수 기반으로 다음 웨이브 진행
   - 웨이브가 진행될수록 적 스폰 속도와 이동 속도 증가
4. **보스전**: 일정 점수 달성 시 강력한 보스 등장
5. **게임 오버**: 생명력이 0이 되면 게임 종료, 획득한 코인으로 업그레이드 가능

### • 다이어그램
```
[메뉴 화면]
    ↓
[게임 시작] → [게임 플레이] → [웨이브 진행] → [보스전]
    ↓              ↓                ↓              ↓
[업그레이드 상점] [일시정지]    [파워업 수집]  [게임 오버]
    ↓              ↓                ↓              ↓
[설정 화면]    [재개/메뉴]    [콤보 시스템]  [점수 저장]
```

---

## 4. 기술적 구현 내용

### • 주요 스크립트 설명

#### 1. **main_screen.js** (게임 상태 관리 및 메인 루프)
- 게임 상태 관리 (`menu`, `playing`, `paused`, `gameOver`)
- 메인 게임 루프 (`update()` 함수)
- 키보드 및 터치 입력 처리
- 일시정지/재개 시스템
- 웨이브 시스템 관리
- UI 화면 전환

**주요 기능**:
- `initGame()`: 게임 초기화
- `update()`: 메인 게임 루프 (60fps)
- `pauseGame()` / `resumeGame()`: 일시정지 시스템
- `handleKeyDown()` / `handleKeyUp()`: 키보드 입력 처리

#### 2. **game_screen.js** (게임 플레이 로직)
- 플레이어 총알 발사 시스템
- 특수 공격 시스템 (미사일, 레이저, 스톰)
- 적 생성 및 업데이트
- 아이템 및 코인 시스템
- 장애물 시스템
- 콤보 시스템

**주요 함수**:
- `shoot()`: 플레이어 총알 발사
- `useSpecialAttack()`: 특수 공격 사용
- `updateEnemies()`: 적 업데이트 및 충돌 처리
- `updateItems()`: 파워업 아이템 업데이트

#### 3. **game_objects.js** (게임 오브젝트 정의)
- 게임 오브젝트 생성 및 관리
- 객체 풀링 시스템 (성능 최적화)
- 적 생성 함수
- 보스 생성 함수
- 이펙트 파티클 시스템

**주요 기능**:
- `getFromPool()` / `returnToPool()`: 객체 풀링으로 메모리 효율성 향상
- `spawnEnemy()`: 다양한 타입의 적 생성
- `spawnBoss()`: 보스 생성

#### 4. **game_collision.js** (충돌 감지 시스템)
- AABB (Axis-Aligned Bounding Box) 충돌 감지
- 그리드 기반 충돌 최적화
- 플레이어-적 충돌
- 총알-적 충돌
- 아이템 수집 충돌

**주요 함수**:
- `isColliding()`: 두 객체 간 충돌 감지
- `checkCollisions()`: 모든 충돌 체크

#### 5. **game_ui.js** (UI 관리)
- 별 배경 렌더링
- 게임 오브젝트 그리기 (적, 아이템, 코인 등)
- HUD (Head-Up Display) 표시
- 게임 정보 표시

**주요 함수**:
- `drawStars()`: 별 배경 그리기
- `drawItems()`: 파워업 아이템 그리기
- `drawCoins()`: 코인 그리기
- `drawUI()`: 게임 정보 UI 그리기

#### 6. **game_audio.js** (오디오 시스템)
- Web Audio API를 활용한 사운드 효과
- 배경음악 생성 및 재생
- 효과음 재생 (발사, 피격, 폭발 등)

**주요 함수**:
- `playSound()`: 효과음 재생
- `playBackgroundMusic()`: 배경음악 재생
- `pauseBackgroundMusic()` / `resumeBackgroundMusic()`: 배경음악 제어

#### 7. **game_storage.js** (로컬 스토리지 관리)
- 최고 점수 저장
- 업그레이드 데이터 저장
- 설정 데이터 저장

#### 8. **option_screen.js** (설정 화면)
- 라이트/다크 모드 전환
- 효과음/배경음악 설정
- 데이터 초기화

### • 클래스/컴포넌트 설명 + 간단한 코드 스냅샷

#### 객체 풀링 시스템 (성능 최적화)
```javascript
// game_objects.js
const objectPools = {
  bullets: [],
  enemies: [],
  enemyBullets: [],
  items: [],
  coins: [],
  effects: [],
  obstacles: []
};

function getFromPool(poolName, createFn) {
  let pool = objectPools[poolName];
  let obj = pool.find(o => !o.active);
  if (!obj) {
    obj = createFn();
    pool.push(obj);
  }
  obj.active = true;
  return obj;
}
```

#### 충돌 감지 시스템
```javascript
// game_collision.js
function isColliding(obj1, obj2) {
  return obj1.x < obj2.x + obj2.width &&
         obj1.x + obj1.width > obj2.x &&
         obj1.y < obj2.y + obj2.height &&
         obj1.y + obj1.height > obj2.y;
}
```

#### 웨이브 시스템
```javascript
// main_screen.js
let currentWave = 1;
let waveStartTime = 0;
let waveDuration = 30; // 웨이브당 30초
let waveKillsRequired = 10; // 웨이브당 처치 필요 수

// 웨이브 진행 체크
const waveElapsedTime = Math.floor((Date.now() - waveStartTime) / 1000);
const timeBased = waveElapsedTime >= waveDuration;
const killBased = waveKills >= waveKillsRequired;
```

### • 문제 해결 경험

#### 1. **일시정지 후 게임 속도 증가 버그**
- **문제**: 일시정지를 했다가 재개하면 게임 속도가 점점 빨라지는 현상
- **원인**: 일시정지 시간이 게임 시간 계산에서 제외되지 않아 웨이브 진행 시간이 비정상적으로 증가
- **해결**: 
  - `pauseStartTime`, `totalPauseTime`, `waveStartTimeAtPause` 변수 도입
  - 재개 시 `waveStartTime`을 일시정지 시작 시점의 값으로 복원하고 일시정지 시간만큼 더함
  - 적 스폰 타이머도 일시정지 시 정지하고 재개 시 재시작하도록 수정

#### 2. **플레이어 텔레포트 버그**
- **문제**: 터치 입력 시 플레이어가 원하지 않는 위치로 텔레포트되는 현상
- **원인**: 터치 이벤트에서 직접 `player.x`, `player.y`를 설정하여 키보드 입력과 충돌
- **해결**: 터치 입력은 `touchTargetX`, `touchTargetY`에 저장하고, 게임 루프에서 부드럽게 이동하도록 수정

#### 3. **보스전 연속 피격 버그**
- **문제**: 보스와 충돌 시 생명력이 연속으로 빠르게 감소
- **원인**: 충돌 감지가 매 프레임마다 실행되어 연속 피격 발생
- **해결**: 무적 시간 시스템 도입 (`player.invincible`, `player.invincibleTimer`)

#### 4. **ESC 키 일시정지 미작동**
- **문제**: ESC 키를 눌러도 일시정지 화면이 나타나지 않음
- **원인**: 이벤트 전파 순서 문제 및 캔버스 포커스 문제
- **해결**: 
  - ESC 키 처리 로직을 함수 최상단으로 이동
  - `e.stopImmediatePropagation()` 추가
  - 캔버스에 `tabindex="0"` 추가 및 포커스 관리

#### 5. **라이트 모드 가시성 문제**
- **문제**: 라이트 모드에서 배경과 플레이어 탄환이 잘 보이지 않음
- **원인**: 밝은 배경에서 노란색/시안색 탄환이 대비가 부족
- **해결**: 
  - 별 배경을 검은색으로 변경
  - 탄환 색상을 주황색/진한 파란색으로 변경
  - 탄환에 테두리 추가

---

## 5. 디자인

### • UI 구성

#### 1. **메뉴 화면**
- 게임 타이틀 (네온 효과)
- 게임 시작 버튼
- 업그레이드 상점 버튼
- 설정 버튼
- 최고 점수 및 보유 코인 표시

#### 2. **게임 플레이 화면**
- HUD (점수, 생명력, 웨이브 정보)
- 별 배경 애니메이션
- 게임 오브젝트 렌더링

#### 3. **업그레이드 상점**
- 보유 코인 표시
- 업그레이드 항목별 레벨 및 비용 표시
- 구매 버튼

#### 4. **설정 화면**
- 조작법 안내
- 테마 전환 (라이트/다크 모드)
- 효과음/배경음악 ON/OFF
- 데이터 초기화 버튼

#### 5. **게임 오버 화면**
- 최종 점수 및 통계 표시
- 획득한 코인 표시
- 다시 시작/메뉴로 버튼

### • 디자인 특징
- **다크 모드**: 우주 느낌의 어두운 배경 (#0a0a2e, #1a1a3e)
- **라이트 모드**: 밝은 배경 (#d0d0d0, #e8e8e8) - 사용자 선택 가능
- **네온 효과**: 주요 UI 요소에 글로우 효과 적용
- **반응형 디자인**: 다양한 화면 크기에 대응

---

## 6. 테스트 및 피드백

### • 테스트 방법
- **자가 테스트**: 개발 과정에서 지속적인 테스트
- **기능 테스트**: 각 게임 시스템별 개별 테스트
- **통합 테스트**: 전체 게임 플레이 플로우 테스트
- **크로스 브라우저 테스트**: Chrome, Firefox, Edge, Safari에서 테스트

### • 발견된 문제점 및 개선

#### 발견된 문제점:
1. 일시정지 후 게임 속도 증가 버그
2. 터치 입력 시 플레이어 텔레포트 버그
3. 보스전 연속 피격 버그
4. ESC 키 일시정지 미작동
5. 라이트 모드 가시성 문제

#### 개선 사항:
1. ✅ 일시정지 시간 보정 시스템 구현
2. ✅ 터치 입력 시스템 개선 (부드러운 이동)
3. ✅ 무적 시간 시스템 도입
4. ✅ 키보드 이벤트 처리 개선
5. ✅ 라이트 모드 색상 조정

---

## 7. 회고 및 느낀 점

### • 어떤 점이 가장 어려웠고 어떤 점에서 성취감을 느꼈는가

**어려웠던 점**:
1. **일시정지 시스템 구현**: 게임 시간 관리와 일시정지 시간 보정이 예상보다 복잡했음. 여러 변수를 동기화하는 것이 어려웠음.
2. **성능 최적화**: 많은 오브젝트가 동시에 화면에 나타날 때 프레임 드롭 발생. 객체 풀링 시스템을 도입하여 해결.
3. **크로스 플랫폼 호환성**: PC와 모바일 모두에서 동작하도록 터치 입력과 키보드 입력을 모두 지원해야 했음.

**성취감을 느낀 점**:
1. **완성된 게임**: 처음부터 끝까지 완성된 게임을 만들어낸 것에 큰 성취감을 느꼈음.
2. **버그 해결**: 복잡한 버그들을 하나씩 해결해나가며 문제 해결 능력이 향상됨을 느꼈음.
3. **사용자 경험 개선**: 라이트 모드, 사운드 시스템, 업그레이드 시스템 등 다양한 기능을 추가하여 게임의 완성도를 높였음.

### • 다음에 만들고 싶은 게임 아이디어
1. **롤플레잉 게임**: 스토리와 캐릭터 성장 시스템이 있는 RPG
2. **퍼즐 게임**: 논리적 사고를 요구하는 퍼즐 게임
3. **멀티플레이어 게임**: 실시간으로 다른 플레이어와 경쟁하는 게임
4. **3D 게임**: Three.js를 활용한 3D 웹 게임

### • 학습적으로 어떤 성장을 했는가
1. **JavaScript 고급 기법**: 클로저, 객체 풀링, 이벤트 처리 등
2. **게임 개발 패턴**: 게임 루프, 상태 관리, 충돌 감지 등
3. **성능 최적화**: 객체 풀링, 그리드 기반 충돌 감지 등
4. **디버깅 능력**: 복잡한 버그를 체계적으로 분석하고 해결하는 능력
5. **사용자 경험 설계**: 직관적인 UI/UX 설계
6. **Web API 활용**: Canvas API, Web Audio API, LocalStorage 등

---

## 8. 스크린샷 및 게임 URL

### • 주요 장면 스크린샷
- 메뉴 화면
- 게임 플레이 화면
- 업그레이드 상점 화면
- 보스전 화면
- 게임 오버 화면

### • 기능별 화면
- 다크 모드 / 라이트 모드 비교
- 특수 공격 사용 화면
- 파워업 아이템 수집 화면
- 웨이브 전환 알림

### • URL 주소
**GitHub 저장소**: https://github.com/Socoms/Galaxy_Defender.git

**로컬 실행**: `index.html` 파일을 웹 브라우저에서 열기

---

## 9. 코드

### • js (파일명)

#### main_screen.js
- 게임 상태 관리
- 메인 게임 루프
- 입력 처리
- 웨이브 시스템
- 일시정지/재개 시스템

#### game_screen.js
- 게임 플레이 로직
- 총알 발사 시스템
- 특수 공격 시스템
- 적 업데이트
- 아이템 시스템

#### game_objects.js
- 게임 오브젝트 정의
- 객체 풀링 시스템
- 적/보스 생성
- 이펙트 시스템

#### game_collision.js
- 충돌 감지 시스템
- AABB 충돌 감지
- 그리드 기반 최적화

#### game_ui.js
- UI 렌더링
- 별 배경 그리기
- 게임 오브젝트 그리기
- HUD 표시

#### game_audio.js
- 사운드 시스템
- Web Audio API 활용
- 배경음악 재생
- 효과음 재생

#### game_storage.js
- 로컬 스토리지 관리
- 데이터 저장/로드
- 설정 저장

#### option_screen.js
- 설정 화면 관리
- 테마 전환
- 사운드 설정

---

## 10. html (파일명)

### index.html
- 게임 구조 정의
- Canvas 요소
- 메뉴 화면
- 업그레이드 상점 화면
- 설정 화면
- 일시정지 화면
- 게임 오버 화면
- JavaScript 파일 로드

---

## 11. css (파일명)

### style.css
- 게임 컨테이너 스타일
- 버튼 스타일
- 화면 오버레이 스타일
- 다크 모드 스타일
- 라이트 모드 스타일
- 반응형 디자인
- 애니메이션 효과

---

## 결론

Galaxy Defender는 HTML5 Canvas와 순수 JavaScript를 활용하여 제작한 웹 기반 액션 슈팅 게임입니다. 웨이브 시스템, 업그레이드 시스템, 다양한 특수 공격 등 다양한 게임 요소를 구현하여 재미있는 게임 경험을 제공합니다. 개발 과정에서 발생한 여러 버그들을 해결하며 게임 개발 능력을 향상시킬 수 있었고, 완성된 게임을 통해 큰 성취감을 느꼈습니다.



